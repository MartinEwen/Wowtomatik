{% extends 'base.html.twig' %}

{% block title %}Edit Characters{% endblock %}

{% block body %}
{% if app.user.id == character.user.id %}
    <h1>Edit Characters</h1>

    {{ include('characters/_form.html.twig', {'button_label': 'Update'}) }}

    <a href="{{ path('app_characters_index') }}">back to list</a>

    {{ include('characters/_delete_form.html.twig') }}
{% else %}
    <h1>Il semblerait que tu te soit perdu</h1>
    <div class="d-grid gap-2 col-6 mx-auto mt-5 mb-5">
        <a class="btn btn-outline-success btn-lg" href="{{ path('main') }}">retour a l'acceuil</a>
    </div>
{% endif %}
    <script>
        $(document).ready(function() {
            $('#characters_race').change(function() {
                $('#characters_classe').attr('disabled', false);
                var selectedRace = $(this).val();
                console.log(selectedRace);
                $.ajax({
                    url: "{{ path('app_characters_new') }}",
                    type: "POST",
                    data: {race: selectedRace},
                    success: function(data) {
                        var options = '';
                        for(var key in data) {
                        options += '<option value="'+key+'">'+data[key]+'</option>';
                        }
                        $('#characters_classe').html(options);
                    }
                });
            });
        });
    </script>
{% endblock %}
