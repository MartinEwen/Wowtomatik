{% extends 'base.html.twig' %}

{% block title %}New Characters{% endblock %}

{% block body %}
    <h1>Create new Characters</h1>

    {{ include('characters/_form.html.twig') }}

    <a href="{{ path('app_characters_index') }}">back to list</a>
     <script>
    window.onload = () => {

        let race = document.querySelector('#characters_race');

        race.addEventListener('change', function(){
            let form = this.closest('form');
            let $data = this.value;
            $classe = $data;
            console.log($classe);
            fetch(form.action, {
                method: form.getAttribute('method'),
                body: $data,
                header: {
                    "Content-type": "application/x-www-form-urlencoded; chaset:UTF-8"
                }
            })
            .then(response => response.text())
            .then(html =>{
                console.log(form.getAttribute('method'), form.action)
                let content = document.createElement('html');
                content.innerHTML = html;
                let newSelect = content.querySelector('#characters_race');
                document.querySelector('#characters_race').replaceWhith(newSelect);
            });
          
        });
    }
    </script>
{% endblock %}
