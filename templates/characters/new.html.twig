{% extends 'base.html.twig' %}

{% block title %}New Characters{% endblock %}

{% block body %}
    <h1>Create new Characters</h1>

    {{ include('characters/_form.html.twig') }}

    <a href="{{ path('app_characters_index') }}">back to list</a>
     {# <script>
    window.onload = () => {

        let race = document.querySelector('#characters_race');

        race.addEventListener('change', function(){
            let form = this.closest('form');
            let data = this.value;
                console.log(data);
            fetch(form.action, {
                method: form.getAttribute("method"),
                body: data,
                headers: {
                    "Content-type": "application/x-www-form-urlencoded; charset:UTF-8"
                }
            })
            
            .then(response => response.text())
            .then(html =>{
                let content = document.createElement('html');
                content.innerHTML = html;
                let newSelect = content.querySelector('#characters_classe');
                document.querySelector('#characters_classe').replaceWith(newSelect);
            })
          .catch(error => {
            console.log(error);
          });
        });
    }
    </script> #}

    <script>
        $(document).ready(function() {
            $('#characters_race').change(function() {
                $('#characters_classe').attr('disabled', false);
                var selectedRace = $(this).val();
                console.log(selectedRace);
                $.ajax({
                    url: "{{ path('app_characters_new') }}",
                    type: "POST",
                    data: {race: selectedRace},
                    success: function(data) {
                        var options = '';
                        for(var key in data) {
                        options += '<option value="'+key+'">'+data[key]+'</option>';
                        }
                        $('#characters_classe').html(options);
                    }
                });
            });
        });
    </script>

   
{% endblock %}
